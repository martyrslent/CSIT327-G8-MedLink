{% extends 'admin_dashboard.html' %}
{% load static %}

{% block title %}Patient Visit Records{% endblock %}

{% block content %}
<div class="content-wrapper">

    <h1 class="page-title">ðŸ“‚ Patient Visit Records (Completed)</h1>

    <!-- ðŸ”Ž SEARCH BAR -->
    <form method="get" style="margin-bottom: 20px;">
        <input 
            type="text" 
            name="search" 
            placeholder="Search patient name..." 
            value="{{ search }}" 
            style="padding: 10px; width: 250px; border: 1px solid #ccc; border-radius: 6px;"
        >
        <button 
            type="submit" 
            style="padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;"
        >
            Search
        </button>
    </form>

    <!-- ðŸ“‹ COMPLETED RECORDS TABLE -->
    <table class="table" style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="border-bottom: 2px solid #ddd;">
                <th style="padding: 10px; text-align: left;">Patient</th>
                <th style="padding: 10px; text-align: left;">Doctor</th>
                <th style="padding: 10px; text-align: left;">Date</th>
                <th style="padding: 10px; text-align: left;">Status</th>
                <th style="padding: 10px; text-align: left;">Notes</th>
            </tr>
        </thead>

        <tbody>
            {% for record in records %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 10px;">
                    {{ record.user_id.first_name }} {{ record.user_id.last_name }}
                </td>
                <td style="padding: 10px;">
                    {{ record.appointment_id.doctor_name|default:"N/A" }}
                </td>
                <td style="padding: 10px;">
                    {{ record.appointment_id.appointment_date }}
                </td>
                <td style="padding: 10px;">
                    <span style="color: green; font-weight: bold;">Completed âœ…</span>
                </td>
                <td style="padding: 10px;">
                    {{ record.doctor_notes|default:"â€”"|truncatechars:80 }}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="padding: 15px; text-align: center;">
                    No completed records found.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</div>
{% endblock %}
