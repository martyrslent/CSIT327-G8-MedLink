{% extends "base.html" %}
{% load static %}

{% block title %}All Doctors{% endblock %}

{% block content %}

<style>
/* -------------------------------------------------------------------------- */
/* ⚙️ STICKY FOOTER FIX (Base.html Integration)               */
/* -------------------------------------------------------------------------- */

/* 1. Ensure the viewport root elements take full height */
html, body {
    height: 100%; /* REQUIRED: Ensures root containers take full viewport height */
    margin: 0; /* Ensures no default spacing pushes content */
    padding: 0;
}

/* 2. Setup the main wrapper (assuming it's .wrapper in base.html) to be a flex container */
.wrapper { 
    min-height: 100%; /* Fix: Ensures the wrapper stretches to the bottom */
    display: flex;
    flex-direction: column;
}

/* Background */
.wrapper, body, html {
    background-image: url('{% static "main/img/wavybg2.png" %}') !important;
    background-size: cover !important;
    background-position: center !important;
    background-repeat: no-repeat !important;
    background-attachment: fixed !important;
    font-family: 'Poppins', sans-serif;
}

/* Page Layout */
.doctor-page {
    display: flex;
    gap: 25px;
    padding: 70px 0 40px;
    max-width: 1300px;
    margin: 0 auto;
    flex-grow: 1; /* FIX: Allows this main content area to take up available vertical space */
}

/* Sidebar */
.filter-sidebar {
    /* ... existing styles ... */
    width: 260px;
    padding: 22px;
    border-radius: 18px;
    background: rgba(255,255,255,0.9);
    box-shadow: 0 6px 18px rgba(0,0,0,0.15);
    backdrop-filter: blur(4px);
    animation: slideInLeft .4s ease-out;
    height: fit-content; /* IMPROVEMENT: Stops sidebar from being full height and potentially causing issues */
    position: sticky; /* IMPROVEMENT: Keeps filter visible when scrolling */
    top: 20px; /* Space from the top */
}

@keyframes slideInLeft {
    from {opacity: 0; transform: translateX(-15px);}
    to {opacity: 1; transform: translateX(0);}
}

.filter-sidebar h3 {
    font-size: 1.4rem;
    margin-bottom: 15px;
    color: #b30000;
    font-weight: 700;
    border-bottom: 2px solid #ffd6c8;
    padding-bottom: 6px;
}

.filter-sidebar ul {
    list-style: none;
    padding: 0;
}

.filter-sidebar li {
    margin: 10px 0;
}

.filter-sidebar a {
    font-size: 1.05rem;
    text-decoration: none;
    color: #b30000;
    font-weight: 500;
    padding: 5px 4px;
    display: block;
    transition: 0.2s;
}

.filter-sidebar a:hover {
    color: #ff5500;
    padding-left: 8px;
}

/* Page Title */
.page-title {
    font-size: 2.7rem;
    font-weight: 800;
    color: #d10000;
    margin-bottom: 25px;
}

/* Doctor Cards Grid */
.doctor-list {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 25px;
}

/* Doctor Card */
.doctor-card {
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    padding: 18px;
    text-align: center;
    display: flex;
    flex-direction: column;
    transition: .25s;
    height: 380px; /* FIXED HEIGHT */
}

.doctor-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 24px rgba(130, 0, 0, 0.35);
}

/* Avatar Fix */
.doc-avatar {
    width: 100%;
    height: 220px; /* CONSISTENT SIZE */
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 12px;
    background: #f3f3f3;
}

.doc-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* PREVENTS DISTORTION */
}

/* Text */
.doctor-card h2 {
    font-size: 1.3rem;
    color: #900000;
    margin: 5px 0;
    font-weight: 700;
}

.doctor-card p {
    font-size: 0.95rem;
    color: #555;
}

/* Status Tags */
.status-available,
.status-unavailable {
    padding: 4px 10px;
    border-radius: 6px;
    font-size: 0.9rem;
    font-weight: 600;
}

.status-available {
    background: #d4edda;
    border: 1px solid #b6dfbf;
    color: #155724;
}

.status-unavailable {
    background: #fff3cd;
    border: 1px solid #ffe8a1;
    color: #856404;
}

/* No Doctor */
.nodoctor {
    grid-column: 1 / -1;
    padding-top: 20px;
    font-size: 1rem;
    text-align: center;
    color: #444;
}

/* Responsive */
@media (max-width: 900px) {
    .doctor-page { flex-direction: column; padding: 40px 25px; }
    .filter-sidebar { width: 100%; }
    .doctor-list { grid-template-columns: 1fr; }
}
</style>

<div class="doctor-page">

    <aside class="filter-sidebar">
        <h3>Specialties</h3>
        <ul>
            <li><a href="?specialty=all">All</a></li>
            <li><a href="?specialty=General Physician">General Physician</a></li>
            <li><a href="?specialty=Dentist">Dentist</a></li>
            <li><a href="?specialty=Pediatrician">Pediatrician</a></li>
            <li><a href="?specialty=Cardiologist">Cardiologist</a></li>
            <li><a href="?specialty=Dermatologist">Dermatologist</a></li>
            <li><a href="?specialty=Gynecologist">Gynecologist</a></li>
            <li><a href="?specialty=Neurologist">Neurologist</a></li>
            <li><a href="?specialty=Orthopedic">Orthopedic</a></li>
            <li><a href="?specialty=Ophthalmologist">Ophthalmologist</a></li>
            <li><a href="?specialty=ENT Specialist">ENT Specialist</a></li>
            <li><a href="?specialty=Psychiatrist">Psychiatrist</a></li>
        </ul>
    </aside>

    <div style="flex: 1;">
        <h1 class="page-title">All Doctors</h1>

        <div class="doctor-list">
            {% if doctors %}
                {% for doc in doctors %}
                <div class="doctor-card">
                    <div class="doc-avatar">
                        {% if doc.profile_image %}
                            <img src="{{ doc.profile_image }}" alt="{{ doc.first_name }}">
                        {% else %}
                            <img src="{% static 'main/img/doctor.png' %}" alt="Default Doctor">
                        {% endif %}
                    </div>

                    <h2>{{ doc.first_name }} {{ doc.last_name }}</h2>
                    <p><strong>Specialty:</strong> {{ doc.specialization }}</p>
                    <p>
                        <strong>Status:</strong>
                        {% if doc.is_in %}
                            <span class="status-available">Available</span>
                        {% else %}
                            <span class="status-unavailable">Not Available</span>
                        {% endif %}
                    </p>
                </div>
                {% endfor %}
            {% else %}
                <div class="nodoctor">No doctors found.</div>
            {% endif %}
        </div>
    </div>

</div>

{% endblock %}